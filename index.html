<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>PTS Warp</title>
    <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline';" />
    <style>
       button{margin-bottom: 5px;}
       input{ margin-bottom: 5px;}
       span{font-weight: bold;}
    </style>
</head>
<body>
    
    
    IP260601</br>
    BAT26NHB</br>
    Vị Trí : <span id="inHere"></span></br>

    <input type="text" id="inputMap" value="" list="inputMap1">
    <datalist id="inputMap1">
        <option value="Thanh Châu">
        <option value="Việt Châu">
        <option value="Quảng Trường Trác Quận"></option>
        <option value="Thành Từ Châu">
        <option value="Thành Hứa Xương"></option>
        <option value="Thành Đông Quận">
        <option value="Rừng Đông Quận"></option>
        <option value="Điểm Binh Đài">
\        <option value="Hoàng Lăng">  
            
    </datalist>

    <button id="btnListWarp">Get List Warp</button>
    <section id="listWarp"></section>
    
   
   <script>
    // include the ipc module to communicate with main process.
    const ipcRenderer = require('electron').ipcRenderer; 
    const fs = require('fs');

    
   
    const btnListWarp= document.getElementById('btnListWarp');
    const listWarp = document.getElementById('listWarp');
    const inHere = document.getElementById('inHere');
    const talkBGH = document.getElementById('talkBGH');
    

    var myData = JSON.parse(fs.readFileSync('dataWarp.json'));


    function addButton(mapName){
        inHere.innerHTML=mapName; // show map name in here

        let listMap=Object.keys(myData[mapName]); //get list map
        
        for(let i=0;i<listMap.length;i++){
            var btn = document.createElement("BUTTON");   // Create a <button> element
            btn.innerHTML = listMap[i];                   // Insert text
            btn.onclick=function(){
                let argReturn=[listMap[i],myData[mapName][listMap[i]]];
                ipcRenderer.send("addListWarp",argReturn); 
            }
            listWarp.appendChild(btn);
            listWarp.appendChild(document.createElement("br")); 
        }
    }


    
    btnListWarp.addEventListener('click', function () {
        let x=document.getElementById("inputMap").value
        listWarp.innerHTML="";
        addButton(x)
    });
    ipcRenderer.on("sendListWarp",(event,arg)=>{
        let selectionPacket=arg.slice(0,4)
        inHere.innerHTML=arg;
        if(selectionPacket!="Talk"||selectionPacket!="BGH-"){
            document.getElementById("inputMap").value="";
            listWarp.innerHTML="";
            addButton(arg)
        }
    }); 

    
    </script>
    
</body>
</html>
